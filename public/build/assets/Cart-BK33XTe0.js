import{j as y,c as k,w as _,a as v,b as t,d as p,h as C,g as d,i as S,o as n,F as q,s as N,t as s,x as T}from"./app-Ct_mwAxD.js";import{S as j}from"./SiteLayout-DEC0OJpP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"mx-auto max-w-7xl px-4 pb-10 pt-[100px]"},E={class:"mt-6 grid gap-6 lg:grid-cols-[1fr,360px]"},X={class:"overflow-hidden rounded-xl border bg-white dark:border-sage dark:bg-darkbrown/40"},B={class:"w-full text-sm"},A={class:"px-4 py-3"},L={class:"flex items-center gap-3"},$=["src"],F={class:"font-medium"},K={class:"text-xs text-gray-500"},M={class:"px-4 py-3"},O={class:"px-4 py-3"},D={class:"inline-flex items-center rounded-md border"},H=["onClick"],P=["value"],I=["onClick"],G={class:"mt-1 text-xs text-gray-500"},V={class:"px-4 py-3"},W={class:"px-4 py-3 text-right"},Y=["onClick"],J={key:0},Q={class:"rounded-xl border bg-white p-4 dark:bg-darkbrown/40"},z={class:"bg-ctext-brown flex items-center justify-between dark:text-cream"},U={class:"text-lg font-semibold"},Z=["disabled"],rt={__name:"Cart",props:{cart:{type:Object,required:!0},total:{type:Number,required:!0}},setup(l){const x=l,c=y(()=>x.cart?.items??[]);function i(r){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(r||0))}async function u(r,e){const o=await fetch(route("cart.items.update",r),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({qty:e})});if(!o.ok){const a=await o.json().catch(()=>({}));window.Swal&&Swal.fire({icon:"error",title:"Gagal",text:a.message||"Tidak bisa mengubah jumlah"});return}window.location.reload()}function b(r){const e=Number(r.product?.stock??1),o=Math.min(Number(r.qty)+1,e);if(o===Number(r.qty)){window.Swal&&Swal.fire({icon:"warning",title:"Maksimal stok",text:"Jumlah sudah mencapai stok tersedia."});return}u(r.id,o)}function f(r){const e=Math.max(1,Number(r.qty)-1);e!==Number(r.qty)&&u(r.id,e)}async function g(r){if(!await m("Hapus produk ini dari cart?"))return;if(!(await fetch(route("cart.items.destroy",r),{method:"DELETE",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).ok){window.Swal&&Swal.fire({icon:"error",title:"Gagal",text:"Tidak bisa menghapus item"});return}window.location.reload()}async function h(){if(!await m("Kosongkan semua item di cart?"))return;if(!(await fetch(route("cart.clear"),{method:"DELETE",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).ok){window.Swal&&Swal.fire({icon:"error",title:"Gagal",text:"Tidak bisa mengosongkan cart"});return}window.location.reload()}function w(r){const e=r?.images?.[0]?.url;return e||`/theme/images/p${Number(r?.id)%8||1}.png`}function m(r){return window.Swal?Swal.fire({title:"Konfirmasi",text:r,icon:"warning",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Batal"}).then(e=>e.isConfirmed):Promise.resolve(confirm(r))}return(r,e)=>(n(),k(j,null,{default:_(()=>[v(p(C),{title:"Your Cart"}),t("section",R,[e[5]||(e[5]=t("h1",{class:"text-2xl font-semibold text-brown dark:text-cream"}," Your Cart ",-1)),t("div",E,[t("div",X,[t("table",B,[e[2]||(e[2]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-brown dark:text-cream"}," Product "),t("th",{class:"px-4 py-3 text-left text-brown dark:text-cream"}," Price "),t("th",{class:"px-4 py-3 text-left text-brown dark:text-cream"}," Qty "),t("th",{class:"px-4 py-3 text-left text-brown dark:text-cream"}," Subtotal "),t("th",{class:"px-4 py-3"})])],-1)),t("tbody",null,[(n(!0),d(q,null,N(c.value,o=>(n(),d("tr",{key:o.id,class:"border-t align-middle"},[t("td",A,[t("div",L,[t("img",{src:w(o.product),class:"h-14 w-14 rounded border object-cover",alt:""},null,8,$),t("div",null,[t("div",F,s(o.product?.name),1),t("div",K,s(o.product?.category?.parent?.name?`${o.product.category.parent.name} → ${o.product.category.name}`:o.product?.category?.name),1)])])]),t("td",M,s(i(o.product?.price)),1),t("td",O,[t("div",D,[t("button",{class:"px-2 py-1",onClick:a=>f(o)}," - ",8,H),t("input",{class:"w-10 border-x bg-white px-2 py-1 text-center dark:bg-brown",value:o.qty,disabled:""},null,8,P),t("button",{class:"px-2 py-1",onClick:a=>b(o)}," + ",8,I)]),t("div",G," Stok: "+s(o.product?.stock??0),1)]),t("td",V,s(i((o.product?.price||0)*(o.qty||0))),1),t("td",W,[t("button",{class:"text-rose-600 hover:underline",onClick:a=>g(o.id)}," Remove ",8,Y)])]))),128)),c.value.length?S("",!0):(n(),d("tr",J,[...e[1]||(e[1]=[t("td",{colspan:"5",class:"px-4 py-10 text-center text-gray-500"}," Keranjang kosong. ",-1)])]))])])]),t("aside",Q,[t("div",z,[e[3]||(e[3]=t("div",{class:"font-medium"},"Total",-1)),t("div",U,s(i(l.total)),1)]),t("button",{class:"mt-3 w-full rounded-md border bg-sage px-4 py-2 hover:bg-sage/80",disabled:!c.value.length,onClick:e[0]||(e[0]=o=>p(T).visit(r.route("checkout.form")))}," Proceed to Checkout ",8,Z),t("button",{class:"mt-3 w-full rounded-md border px-4 py-2 hover:bg-gray-50",onClick:h}," Clear Cart "),e[4]||(e[4]=t("p",{class:"mt-3 text-xs text-gray-500"}," ",-1))])])])]),_:1}))}};export{rt as default};
